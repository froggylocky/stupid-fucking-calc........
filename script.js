let B, G = 1, M = [], D = document, $ = id => D.getElementById(id), L = Math, E = L.E, P = L.PI, f = n => n < 0 ? 0 / 0 : n < 2 ? 1 : n * f(n - 1), j = () => { let l = B.value.length; B.style.fontSize = l > 20 ? '1em' : l > 15 ? '1.2em' : l > 10 ? '1.5em' : '2em' }, u = () => { let l = $('l'); l.innerHTML = M.length ? M.map((v, i) => `<div class=i onclick=r(${i})><span class=val>${v}</span><button class=del onclick="k(${i},event)">Ã—</button></div>`).join('') : '<div class=empty-msg>No saved values</div>' }, t = () => { G = !G; $('g').textContent = G ? 'DEG' : 'RAD' }, s = () => { try { M.unshift(+(L.round(e(v()) + 'e10') + 'e-10')); u() } catch (e) { B.value = 'Error' } }, r = i => { let k = M[i], v = B.value; B.value = v && !'+-*/^(='.includes(v.slice(-1)) ? v + '+' + k : v + k; j() }, k = (i, e) => { e.stopPropagation(); M.splice(i, 1); u() }, m = () => { M = []; u() }, v = () => B.value.startsWith('x = ') ? B.value.slice(4) : ['Error', 'Infinity', 'NaN', 'No solution found', 'No x found'].includes(B.value) ? '0' : B.value || '0', e = E => { let f = G ? '*Math.PI/180' : '', x = E.replace(/x/g, '(0)').replace(/PI/g, 'Math.PI').replace(/E/g, 'Math.E').replace(/sqrt\(([^)]+)\)/g, 'Math.sqrt($1)').replace(/sqr\(([^)]+)\)/g, 'Math.pow($1,2)').replace(/inv\(([^)]+)\)/g, '(1/($1))').replace(/sin\(([^)]+)\)/g, `Math.sin(($1)${f})`).replace(/cos\(([^)]+)\)/g, `Math.cos(($1)${f})`).replace(/tan\(([^)]+)\)/g, `Math.tan(($1)${f})`).replace(/log\(([^)]+)\)/g, 'Math.log10($1)').replace(/ln\(([^)]+)\)/g, 'Math.log($1)').replace(/\^/g, '**').replace(/(\d+)!/g, 'f($1)'); return eval(x) }, a = v => { if (['Error', 'Infinity', 'NaN', 'No solution found', 'No x found'].includes(B.value) || B.value.startsWith('x =')) B.value = ''; let l = B.value.slice(-1); if ('+-*/^='.includes(v) && '+-*/^='.includes(l)) B.value = B.value.slice(0, -1) + v; else if (v == '.' && B.value.split(/[+\-*/ ()^=]/).pop().includes('.')) return; else B.value += v; j() }, c = () => { B.value = ''; j() }, d = () => { B.value = ['Error', 'Infinity', 'NaN', 'No solution found', 'No x found'].includes(B.value) || B.value.startsWith('x =') ? '' : B.value.slice(0, -1); j() }, S = () => { try { let v = B.value; if (v.includes('x') || v.includes('=')) x(); else B.value = +(L.round(e(v) + 'e10') + 'e-10') } catch (e) { B.value = 'Error' } j() }, x = () => { try { let v = B.value; if (!v.includes('x')) { B.value = 'No x found'; return } let q = v.includes('=') ? `(${(v.split('=')[0] || 0)}) -(${(v.split('=')[1] || 0)})` : v, x = 0, h = 1e-6, T = 1e-7; for (let i = 0; i < 100; i++) { let f = e(q.replace(/x/g, `(${x})`)); if (L.abs(f) < T) { B.value = 'x = ' + +(L.round(x + 'e10') + 'e-10'); j(); return } let d = (e(q.replace(/x/g, `(${x + h})`)) - f) / h; if (L.abs(d) < T) { x += 1; continue } x -= f / d } B.value = 'No solution found' } catch (e) { B.value = 'Error' } j() }; D.addEventListener('keydown', e => { let k = e.key; if (/^[0-9x.]$/.test(k)) a(k == ',' ? '.' : k); if ('+-*/^()='.includes(k)) a(k); if (k == 'Enter') { e.preventDefault(); S() } if (k == 'Backspace') d(); if (k == 'Escape') c() }); B = $('i');